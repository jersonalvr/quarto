"0","class MangoLeafDataset(Dataset):"
"0","    def __init__(self, dataframe, transform=None):"
"0","        """""""
"0","        Args:"
"0","            dataframe (pd.DataFrame): DataFrame que contiene las rutas de las imágenes y sus etiquetas."
"0","            transform (callable, optional): Transformaciones a aplicar a las imágenes."
"0","        """""""
"0","        self.filepaths = dataframe['filepaths'].values"
"0","        self.labels = dataframe['labels'].values"
"0","        self.transform = transform"
"0","        self.classes = sorted(dataframe['labels'].unique())"
"0","        self.class_to_idx = {cls_name: idx for idx, cls_name in enumerate(self.classes)}"
"0","        self.labels_idx = [self.class_to_idx[label] for label in self.labels]"
"0","        "
"0","    def __len__(self):"
"0","        return len(self.filepaths)"
"0","        "
"0","    def __getitem__(self, idx):"
"0","        img_path = self.filepaths[idx]"
"0","        image = Image.open(img_path).convert('RGB')  # Asegurarse de que la imagen tenga 3 canales"
"0","        label = self.labels_idx[idx]"
"0","        "
"0","        if self.transform:"
"0","            image = self.transform(image)"
"0","            "
"0","        return image, label"
"0",""
